% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HelperFunctions.R
\name{expect_equal_abs}
\alias{expect_equal_abs}
\title{Expect approximate equality by absolute tolerance}
\usage{
expect_equal_abs(
  object,
  expected,
  ...,
  tolerance = 0.01,
  info = NULL,
  label = NULL,
  expected.label = NULL
)
}
\arguments{
\item{object}{Expression or value producing the actual result.}

\item{expected}{Expression or value producing the reference result.
If \code{expected} is \code{NULL} or \code{NA}, the expectation succeeds
silently (useful when reference data are not available). Even single \code{NA}
entries in matrices are ignored and can be anyhing in \code{object}.}

\item{...}{Additional arguments forwarded to \code{\link[waldo:compare]{waldo::compare()}} for
generating diffs in failure messages (not used in the tolerance check).}

\item{tolerance}{A non-negative numeric scalar. The maximum allowed
absolute difference per element. Default: \code{0.01}.}

\item{info}{A character string appended to the failure message.}

\item{label, expected.label}{Optional labels used in messages to describe
\code{object} and \code{expected}. By default they are derived from the expressions.}
}
\value{
Invisibly returns \code{object} on success; otherwise signals a testthat
expectation failure.
}
\description{
Checks that \code{object} and \code{expected} are approximately equal using an
element-wise absolute tolerance. This is similar to
\code{\link[testthat:equality-expectations]{testthat::expect_equal()}}, but uses \code{abs(x - y) <= tolerance} as the
element-wise criterion and treats missing reference values as a no-op.
}
\details{
The comparison is vectorised and applies the rule \code{abs(x - y) <= tolerance}
element-wise. All elements must satisfy the rule for the expectation to pass.
The function mirrors testthat conventions:
\itemize{
\item On success, it succeeds silently and returns \code{object} invisibly.
\item On failure, it throws an expectation error with a \code{waldo} diff.
}

Special handling:
\itemize{
\item If \code{expected} is \code{NULL} or all values in \code{expected} are \code{NA}, the check
is skipped and the expectation succeeds silently. Similarly, individual
\code{NA} entries in \code{expected} are skipped and allow any value in \code{object}.
}
}
\examples{
# Passes: absolute differences â‰¤ 0.01
expect_equal_abs(c(1, 2, 3), c(1.001, 1.999, 3.0001), tolerance = 0.01)

# Fails with a waldo diff when any element exceeds tolerance
\dontrun{
expect_equal_abs(c(1, 2, 3), c(1.1, 2, 3), tolerance = 0.05)
}

# Skips check when expected is NULL or all NA
expect_equal_abs(1:3, NULL)
expect_equal_abs(1:3, c(NA, NA, NA))

# Forward options to waldo::compare for clearer diffs
\dontrun{
expect_equal_abs(1:3, 1:3 + 1e-4, tolerance = 0,
                 ignore_attr = TRUE, max_diffs = 10)
}
}
\seealso{
\code{\link[testthat:equality-expectations]{testthat::expect_equal()}}, \code{\link[waldo:compare]{waldo::compare()}}
}
